#include "minilibx/mlx.h" // 環境に合わせてパスを調整してください
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    void    *mlx_ptr;   // 接続ID
    void    *win_ptr;   // ウィンドウID
    void    *img_ptr;   // 画像データID
    int     width;      // 画像の幅を受け取る変数
    int     height;     // 画像の高さを受け取る変数
	char	*filename;

    printf("Starting MiniLibX...\n");

    // 1. MLX初期化 (接続開始)
    mlx_ptr = mlx_init();
    if (mlx_ptr == NULL)
    {
        printf("Error: mlx_init failed\n");
        return (1);
    }

    // 2. ウィンドウ作成 (400x400のサイズで)
    win_ptr = mlx_new_window(mlx_ptr, 400, 400, "Simple Image Test");
    if (win_ptr == NULL)
    {
        printf("Error: mlx_new_window failed\n");
        return (1);
    }

    // 3. XPM画像をロード
    // ⚠️注意: ファイルパスが間違っていると NULL が返ります
	filename = "./textures/player/player_front1.xpm";
    printf("Loading image...\n");
    img_ptr = mlx_xpm_file_to_image(mlx_ptr, filename, &width, &height);
    
    if (img_ptr == NULL)
    {
        printf("Error: Failed to load %s.\n", filename);
        printf("Make sure the file exists and the path is correct.\n");
        // ウィンドウと接続を閉じて終了
        mlx_destroy_window(mlx_ptr, win_ptr);
        return (1);
    }
    printf("Success! Loaded %dx%d image.\n", width, height);

    // 4. 画像をウィンドウに貼り付け
    // 座標(180, 180)あたりに表示してみる
    mlx_put_image_to_window(mlx_ptr, win_ptr, img_ptr, 180, 180);

    printf("Window is open. Press [Ctrl+C] in the terminal to quit.\n");

    // 5. イベントループ開始 (ここでプログラムが待機状態になる)
    mlx_loop(mlx_ptr);

    return (0);
}
